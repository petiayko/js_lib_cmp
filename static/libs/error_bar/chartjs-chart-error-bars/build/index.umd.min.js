!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("chart.js"),require("chart.js/helpers")):"function"==typeof define&&define.amd?define(["exports","chart.js","chart.js/helpers"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).ChartErrorBars={},e.Chart,e.Chart.helpers)}(this,(function(e,r,t){"use strict";const a=["xMin","xMax","yMin","yMax"];function n(e){return e?a.slice(0,2):a.slice(2)}function s(e,r,t,a,n){const s=[`${a.axis}Min`,`${a.axis}Max`],o=a.getBasePixel();for(const l of s){const s=r[l];Array.isArray(s)?e[l]=s.map((e=>n?o:a.getPixelForValue(e,t))):"number"==typeof s&&(e[l]=n?o:a.getPixelForValue(s,t))}}const o={errorBarLineWidth:{v:[1,3]},errorBarColor:{v:["#2c2c2c","#1f1f1f"]},errorBarWhiskerLineWidth:{v:[1,3]},errorBarWhiskerRatio:{v:[.2,.25]},errorBarWhiskerSize:{v:[20,24]},errorBarWhiskerColor:{v:["#2c2c2c","#1f1f1f"]}},l={_scriptable:!0,_indexable:e=>"v"!==e},i=Object.keys(o);function c(e,r){const t=Array.isArray(e)?e:[e],a=Array.isArray(r)?r:[r];if(t.length===a.length)return t.map(((e,r)=>[e,a[r]]));const n=Math.max(t.length,a.length);return Array(n).map(((e,r)=>[t[r%t.length],a[r%a.length]]))}function u(e,r){if("string"==typeof e||"number"==typeof e)return e;const t=Array.isArray(e)?e:e.v;return t[r%t.length]}function d(e,r,t){const a=u(r.errorBarWhiskerRatio,t);if(null!=e&&a>0)return e*a*.5;return.5*u(r.errorBarWhiskerSize,t)}function h(e,r){var t,a,n,s;const o=e.getProps(["x","y","width","height","xMin","xMax","yMin","yMax"]);null==o.xMin&&null==o.xMax||function(e,r,t,a,n){n.save(),n.translate(0,e.y);const s=c(null==r?e.x:r,null==t?e.x:t);s.reverse().forEach((([r,t],o)=>{const l=s.length-o-1,i=d(e.height,a,l);n.lineWidth=u(a.errorBarLineWidth,l),n.strokeStyle=u(a.errorBarColor,l),n.beginPath(),n.moveTo(r,0),n.lineTo(t,0),n.stroke(),n.lineWidth=u(a.errorBarWhiskerLineWidth,l),n.strokeStyle=u(a.errorBarWhiskerColor,l),n.beginPath(),n.moveTo(r,-i),n.lineTo(r,i),n.moveTo(t,-i),n.lineTo(t,i),n.stroke()})),n.restore()}(o,null!==(t=o.xMin)&&void 0!==t?t:null,null!==(a=o.xMax)&&void 0!==a?a:null,e.options,r),null==o.yMin&&null==o.yMax||function(e,r,t,a,n){n.save(),n.translate(e.x,0);const s=c(null==r?e.y:r,null==t?e.y:t);s.reverse().forEach((([r,t],o)=>{const l=s.length-o-1,i=d(e.width,a,l);n.lineWidth=u(a.errorBarLineWidth,l),n.strokeStyle=u(a.errorBarColor,l),n.beginPath(),n.moveTo(0,r),n.lineTo(0,t),n.stroke(),n.lineWidth=u(a.errorBarWhiskerLineWidth,l),n.strokeStyle=u(a.errorBarWhiskerColor,l),n.beginPath(),n.moveTo(-i,r),n.lineTo(i,r),n.moveTo(-i,t),n.lineTo(i,t),n.stroke()})),n.restore()}(o,null!==(n=o.yMin)&&void 0!==n?n:null,null!==(s=o.yMax)&&void 0!==s?s:null,e.options,r)}function p(e,r){const t=e.getProps(["x","y","startAngle","endAngle","rMin","rMax","outerRadius"]);null==t.rMin&&null==t.rMax||function(e,r,t,a,n){n.save(),n.translate(e.x,e.y);const s=(e.startAngle+e.endAngle)/2,o=Math.cos(s),l=Math.sin(s),i={x:-l,y:o},h=Math.sqrt(i.x*i.x+i.y*i.y);i.x/=h,i.y/=h;const p=c(null!=r?r:e.outerRadius,null!=t?t:e.outerRadius);p.reverse().forEach((([e,r],t)=>{const s=p.length-t-1,c=e*o,h=e*l,f=r*o,m=r*l,x=d(null,a,s),y=i.x*x,g=i.y*x;n.lineWidth=u(a.errorBarLineWidth,s),n.strokeStyle=u(a.errorBarColor,s),n.beginPath(),n.moveTo(c,h),n.lineTo(f,m),n.stroke(),n.lineWidth=u(a.errorBarWhiskerLineWidth,s),n.strokeStyle=u(a.errorBarWhiskerColor,s),n.beginPath(),n.moveTo(c+y,h+g),n.lineTo(c-y,h-g),n.moveTo(f+y,m+g),n.lineTo(f-y,m-g),n.stroke()})),n.restore()}(t,t.rMin,t.rMax,e.options,r)}class f extends r.BarElement{draw(e){super.draw(e),h(this,e)}}f.id="barWithErrorBar",f.defaults={...r.BarElement.defaults,...o},f.defaultRoutes=r.BarElement.defaultRoutes,f.descriptors=l;class m extends r.PointElement{draw(e,r){super.draw.call(this,e,r),h(this,e)}}m.id="pointWithErrorBar",m.defaults={...r.PointElement.defaults,...o},m.defaultRoutes=r.PointElement.defaultRoutes,m.descriptors=l;class x extends r.ArcElement{draw(e){super.draw(e),p(this,e)}}function y(e){return Array.isArray(e)?e.slice().reverse():e}function g(e){const t=n(e.element.horizontal),a=r.Tooltip.defaults.callbacks.label.call(this,e),s=e.chart.data.datasets[e.datasetIndex].data[e.dataIndex];return null==s||t.every((e=>null==s[e]))?a:`${a} (${y(s[t[0]])} .. ${s[t[1]]})`}x.id="arcWithErrorBar",x.defaults={...r.ArcElement.defaults,...o},x.defaultRoutes=r.ArcElement.defaultRoutes,x.descriptors=l;const M={color(e,r,a){const n=e||"transparent",s=r||"transparent";if(n===s)return r;const o=t.color(n),l=o.valid&&t.color(s);return l&&l.valid?l.mix(o,a).hexString():r},number:(e,r,t)=>e===r?r:e+(r-e)*t};function E(e,r,t,a,n){if(typeof e===a&&typeof r===a)return n(e,r,t);if(Array.isArray(e)&&Array.isArray(r))return e.map(((e,a)=>n(e,r[a],t)));const s=e=>e&&Array.isArray(e.v);return s(e)&&s(r)?{v:e.v.map(((e,a)=>n(e,r.v[a],t)))}:r}const b={animations:{numberArray:{fn:function(e,r,t){return E(e,r,t,"number",M.number)},properties:a.concat(i.filter((e=>!e.endsWith("Color"))),["rMin","rMax"])},colorArray:{fn:function(e,r,t){return E(e,r,t,"string",M.color)},properties:i.filter((e=>e.endsWith("Color")))}}};function B(e,r){const{axis:t}=e;e.axis=`${t}MinMin`;const{min:a}=r(e);e.axis=`${t}MaxMax`;const{max:n}=r(e);return e.axis=t,{min:a,max:n}}function v(e,r,t){return Array.isArray(r)?t(...r):"number"==typeof r?r:e}function C(e,r,t,a,n){const s="string"==typeof r?r:r.axis,o=`${s}Min`,l=`${s}Max`,i=`${s}MinMin`,c=`${s}MaxMax`;for(let r=0;r<n;r+=1){const n=r+a,u=e[r];u[o]=t[n][o],u[l]=t[n][l],u[i]=v(u[s],u[o],Math.min),u[c]=v(u[s],u[l],Math.max)}}function W(e,r,t,a){const{axis:n}=r,s=r.getLabels();for(let o=0;o<a;o+=1){const a=o+t;e[o][n]=r.parse(s[a],a)}}function A(e,t,a,n=[],s=[]){r.registry.addControllers(a),Array.isArray(n)?r.registry.addElements(...n):r.registry.addElements(n),Array.isArray(s)?r.registry.addScales(...s):r.registry.addScales(s);const o=t;return o.type=e,o}class S extends r.BarController{getMinMax(e,r){return B(e,(e=>super.getMinMax(e,r)))}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return C(n,e.vScale,r,t,a),W(n,e.iScale,t,a),n}updateElement(e,r,t,a){"number"==typeof r&&s(t,this.getParsed(r),r,this._cachedMeta.vScale,"reset"===a),super.updateElement(e,r,t,a)}}S.id="barWithErrorBars",S.defaults=t.merge({},[r.BarController.defaults,b,{dataElementType:f.id}]),S.overrides=t.merge({},[r.BarController.overrides,{plugins:{tooltip:{callbacks:{label:g}}}}]),S.defaultRoutes=r.BarController.defaultRoutes;class k extends r.Chart{constructor(e,t){super(e,A("barWithErrorBars",t,S,f,[r.LinearScale,r.CategoryScale]))}}k.id=S.id;class P extends r.LineController{getMinMax(e,r){return B(e,(e=>super.getMinMax(e,r)))}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return C(n,e.vScale,r,t,a),W(n,e.iScale,t,a),n}updateElement(e,r,t,a){e instanceof m&&"number"==typeof r&&this.updateElementScale(r,t,a),super.updateElement(e,r,t,a)}updateElementScale(e,r,t){s(r,this.getParsed(e),e,this._cachedMeta.vScale,"reset"===t)}updateElements(e,r,t,a){const n="reset"===a,s=this.chart._animationsDisabled||n||"none"===a;if(super.updateElements(e,r,t,a),s)for(let n=r;n<r+t;++n){const r=e[n];r instanceof m&&this.updateElementScale(n,r,a)}}}P.id="lineWithErrorBars",P.defaults=t.merge({},[r.LineController.defaults,b,{dataElementType:m.id}]),P.overrides=t.merge({},[r.LineController.overrides,{plugins:{tooltip:{callbacks:{label:g}}}}]),P.defaultRoutes=r.LineController.defaultRoutes;class T extends r.Chart{constructor(e,t){super(e,A("lineWithErrorBars",t,P,m,[r.LinearScale,r.CategoryScale]))}}T.id=P.id;class $ extends r.ScatterController{getMinMax(e,r){return B(e,(e=>super.getMinMax(e,r)))}parseObjectData(e,r,t,a){const n=super.parseObjectData(e,r,t,a);return C(n,e.xScale,r,t,a),C(n,e.yScale,r,t,a),n}updateElement(e,r,t,a){e instanceof m&&"number"==typeof r&&this.updateElementScale(r,t,a),super.updateElement(e,r,t,a)}updateElementScale(e,r,t){s(r,this.getParsed(e),e,this._cachedMeta.xScale,"reset"===t),s(r,this.getParsed(e),e,this._cachedMeta.yScale,"reset"===t)}updateElements(e,r,t,a){const n="reset"===a,s=this.chart._animationsDisabled||n||"none"===a;if(super.updateElements(e,r,t,a),s)for(let n=r;n<r+t;++n){const r=e[n];r instanceof m&&this.updateElementScale(n,r,a)}}}$.id="scatterWithErrorBars",$.defaults=t.merge({},[r.ScatterController.defaults,b,{dataElementType:m.id}]),$.overrides=t.merge({},[r.ScatterController.overrides,{plugins:{tooltip:{callbacks:{label:function(e){const r=e.chart.data.datasets[e.datasetIndex].data[e.dataIndex],t=(e,t)=>{const a=n(t);return null==r||a.every((e=>null==r[e]))?e:`${e} [${y(r[a[0]])} .. ${r[a[1]]}]`};return`(${t(e.label,!0)}, ${t(e.parsed.y,!1)})`}}}}}]),$.defaultRoutes=r.LineController.defaultRoutes;class L extends r.Chart{constructor(e,t){super(e,A("scatterWithErrorBars",t,$,m,[r.LinearScale]))}}L.id=$.id;class R extends r.PolarAreaController{getMinMaxImpl(e){const r=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return r.data.forEach(((r,a)=>{const n=this.getParsed(a)[e.axis];!Number.isNaN(n)&&this.chart.getDataVisibility(a)&&(n<t.min&&(t.min=n),n>t.max&&(t.max=n))})),t}getMinMax(e){return B(e,(e=>this.getMinMaxImpl(e)))}countVisibleElements(){const e=this._cachedMeta;return e.data.reduce(((r,t,a)=>!Number.isNaN(e._parsed[a].r)&&this.chart.getDataVisibility(a)?r+1:r),0)}parseObjectData(e,r,t,a){const n=new Array(a),s=e.rScale;for(let e=0;e<a;e+=1){const a=e+t,o=r[a],l=s.parse(o[s.axis],a);n[e]={[s.axis]:l}}return C(n,s,r,t,a),n}updateElement(e,r,t,a){"number"==typeof r&&function(e,r,t,a,n){const s=n.animation,o=[`${t.axis}Min`,`${t.axis}Max`],l=e=>{const r=t.getDistanceFromCenterForValue(e),n=s.animateScale?0:r;return a?n:r};for(const t of o){const a=r[t];Array.isArray(a)?e[t]=a.map(l):"number"==typeof a&&(e[t]=l(a))}}(t,this.getParsed(r),this._cachedMeta.rScale,"reset"===a,this.chart.options),super.updateElement(e,r,t,a)}updateElements(e,r,t,a){const n=this.chart.scales.r,s=n.getDistanceFromCenterForValue;n.getDistanceFromCenterForValue=function(e){return"number"==typeof e?s.call(this,e):s.call(this,e.r)},super.updateElements(e,r,t,a),n.getDistanceFromCenterForValue=s}}R.id="polarAreaWithErrorBars",R.defaults=t.merge({},[r.PolarAreaController.defaults,b,{dataElementType:x.id}]),R.overrides=t.merge({},[r.PolarAreaController.overrides,{plugins:{tooltip:{callbacks:{label:function(e){const t=r.PolarAreaController.overrides.plugins.tooltip.callbacks.label.call(this,e),a=e.chart.data.datasets[e.datasetIndex].data[e.dataIndex],n=["rMin","rMax"];return null==a||n.every((e=>null==a[e]))?t:`${t} [${y(a[n[0]])} .. ${a[n[1]]}]`}}}}}]),R.defaultRoutes=r.PolarAreaController.defaultRoutes;class I extends r.Chart{constructor(e,t){super(e,A("polarAreaWithErrorBars",t,R,x,[r.RadialLinearScale]))}}I.id=R.id,r.registry.addControllers(S,P,R,$),r.registry.addElements(f,x,m),e.ArcWithErrorBar=x,e.BarWithErrorBar=f,e.BarWithErrorBarsChart=k,e.BarWithErrorBarsController=S,e.LineWithErrorBarsChart=T,e.LineWithErrorBarsController=P,e.PointWithErrorBar=m,e.PolarAreaWithErrorBarsChart=I,e.PolarAreaWithErrorBarsController=R,e.ScatterWithErrorBarsChart=L,e.ScatterWithErrorBarsController=$,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
